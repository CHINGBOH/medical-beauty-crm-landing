# 医美智能营销管理系统 - 开发任务清单

## ✅ 已完成功能

### 基础架构
- [x] 设计医美风格主题配色和字体
- [x] 配置全局样式和 Tailwind 主题
- [x] 设计数据库表结构（本地 + Airtable 映射）
- [x] 实现 Airtable API 集成工具函数
- [x] 配置 DeepSeek API 集成
- [x] 配置 Qwen API 集成
- [x] 创建知识库数据表结构

### AI 客服机器人
- [x] 创建聊天界面组件（使用 AIChatBox）
- [x] 实现 LLM 对话接口（DeepSeek API）
- [x] 设计医美行业专业 prompt
- [x] 实现对话中自动提取客户信息
- [x] 创建对话历史记录表
- [x] 实现对话转线索功能

### 知识库系统
- [x] 创建知识库数据表（标题、内容、分类、标签）
- [x] 集成 RAG 检索增强生成
- [x] 导入医美项目初始知识
- [x] 添加知识引用统计功能

### 引流落地页
- [x] 创建落地页布局和导航
- [x] 实现超皮秒祛斑项目展示区
- [x] 设计并实现表单组件（姓名、手机、微信、意向项目、预算、留言）
- [x] 实现表单验证逻辑
- [x] 创建表单提交 API（tRPC procedure）
- [x] 实现 Airtable 线索写入功能
- [x] 实现 URL 参数识别来源渠道
- [x] 添加提交成功提示和引导

### Airtable 集成
- [x] 创建 Airtable 配置管理页面
- [x] 实现配置保存功能（存储到数据库）
- [x] 实现连接测试功能
- [x] 创建管理后台导航和布局
- [x] 测试完整流程
- [x] 调研 Airtable Metadata API 和 Base 创建能力
- [x] 实现自动创建 Base 功能
- [x] 实现自动创建表结构（线索表、客户表等）
- [x] 实现自动配置字段和关联
- [x] 优化配置界面为一键连接
- [x] 测试完整自动化流程

### Qwen API 集成（管理功能）
- [x] 配置 Qwen API Key
- [x] 创建 Qwen LLM 工具函数
- [x] 实现智能数据分析功能
- [x] 实现客户画像生成功能
- [x] 实现营销建议功能
- [x] 创建管理后台分析页面
- [x] 测试 Qwen API 功能

### SEO 优化
- [x] 添加首页页面标题（30-60字符）
- [x] 添加首页描述信息（50-160字符）
- [x] 添加关键词 meta 标签
- [x] 优化页面内容关键词密度
- [x] 测试 SEO 优化效果

### 品牌风格调整
- [x] 更新主题配色为妍美金棕色系（#B8A68D）
- [x] 上传并集成妍美 Logo
- [x] 更新品牌名称为"深圳妍美医疗美容门诊部"
- [x] 调整落地页配色和样式
- [x] 调整聊天页面配色和样式
- [x] 更新按钮和交互元素颜色
- [x] 调整渐变效果为金棕色系

### 紧急修复
- [x] 修复 DeepSeek API 密钥认证失败问题
- [x] 测试 AI 客服对话功能
- [x] 修复 Admin 页面 React error #301
- [x] 修复 useState 在渲染时调用的问题
- [x] 重新发布并验证
- [x] 检查 Chat 页面留资表单弹窗功能
- [x] 修复"留下联系方式"按钮点击无响应问题
- [x] 测试表单提交到 Airtable 功能

---

## 🚀 第一阶段：核心管理后台（进行中）

### Dashboard 布局
- [x] 创建 DashboardLayout 组件（侧边栏 + 内容区）
- [x] 设计侧边栏导航结构（配置、分析、对话、内容、客户）
- [x] 添加顶部导航栏（用户信息、通知、快捷操作）
- [x] 实现响应式布局（移动端适配）

### 页面重构
- [x] 重构 Admin 页面为 Dashboard 子页面
- [x] 重构 Analytics 页面为 Dashboard 子页面
- [x] 创建对话管理页面（Conversations）
- [x] 实现对话列表（分页、筛选、搜索）
- [x] 实现对话详情查看
- [ ] 实现对话标记和分类

### Airtable 双向交互
- [ ] 实现 AI 对话自动写入 Airtable
- [ ] 实现从 Airtable 读取客户信息
- [ ] 实现客户信息增强 AI 回复
- [ ] 测试双向交互功能

### 双知识库系统
- [x] 设计双知识库数据表结构（客户问询 + 内部管理）
- [x] 实现客户问询知识库管理页面
- [x] 实现内部管理知识库管理页面
- [x] 实现知识库分类和标签管理
- [x] 实现知识库搜索和筛选
- [x] 实现权限控制（内部知识库仅员工可见）
- [x] 编写《医美诊所知识库资料收集清单》文档
- [x] 输出客户问询知识库内容清单
- [x] 输出内部管理知识库内容清单

---

## 📝 第二阶段：内容营销系统

### 一键生成爱文
- [x] 创建内容管理页面（Content）
- [x] 实现一键生成爱文功能（标题 + 正文 + 话题标签）
- [x] 实现内容模板管理（不同项目的文案模板）
- [ ] 集成图片生成功能（复用小红书图文生成）
- [x] 实现内容预览和导出

### 素材管理
- [ ] 实现图文素材上传
- [ ] 实现素材编辑和删除
- [ ] 实现素材分类和标签
- [ ] 实现素材搜索和筛选

### 数据库
- [ ] 创建 content_posts 表
- [ ] 创建内容模板表
- [ ] 创建素材库表

---

## 👥 第三阶段：客户画像增强

### 心理标签系统
- [ ] 扩展客户表，添加心理标签字段
- [ ] 实现心理标签自动识别（LLM 分析对话）
- [ ] 实现心理动机分类（恐惧/贪婪/安全/敏感）
- [ ] 实现消费决策分类（冲动/理性/犹豫）
- [ ] 实现体验敏感度分类（视觉/听觉/触觉/嗅觉/味觉）

### 客户分层分级
- [ ] 实现客户分层逻辑（VIP/潜力/普通/流失）
- [ ] 实现消费周期追踪
- [ ] 实现客户价值计算
- [ ] 实现流失预警机制

### 客户管理页面
- [ ] 创建客户管理页面（Customers）
- [ ] 实现客户列表、筛选、搜索
- [ ] 实现客户详情页（画像 + 消费记录 + 对话历史）
- [ ] 实现重要事件标记和提醒

### 数据库
- [ ] 创建 customer_tags 表
- [ ] 创建 customer_events 表
- [ ] 创建客户分层规则表

---

## ⚡ 第四阶段：自动化触发系统

### 时间触发
- [ ] 实现生日提醒（提前7天）
- [ ] 实现节假日营销（三八、520、双11等）
- [ ] 实现定时回访（术后3/7/30天）
- [ ] 实现复购提醒（根据项目周期）

### 行为触发
- [ ] 实现客户流失预警（90天未消费）
- [ ] 实现高价值客户识别（累计消费达标）
- [ ] 实现咨询未转化跟进（3天内未预约）

### 天气触发
- [ ] 集成天气 API（和风天气/高德天气）
- [ ] 实现降温提醒（温差>8°C）
- [ ] 实现台风/暴雨预警
- [ ] 实现高温预警（>35°C）
- [ ] 实现空气质量预警（AQI>150）

### 触发管理
- [ ] 创建触发规则管理页面
- [ ] 实现触发规则配置
- [ ] 实现触发动作执行（企业微信推送、AI 主动对话、分配顾问）
- [ ] 实现触发历史记录和效果追踪
- [ ] 创建定时任务系统（Node.js cron）

### 数据库
- [ ] 创建 trigger_rules 表
- [ ] 创建 trigger_logs 表
- [ ] 创建天气数据缓存表

---

## 📱 第五阶段：小红书运营管理

### 账户数据监控
- [ ] 调研小红书 API 或第三方工具（蝉妈妈、新红）
- [ ] 创建小红书运营页面（Xiaohongshu）
- [ ] 实现账户数据监控（浏览、点赞、评论、收藏）
- [ ] 实现数据报表和趋势分析

### 评论管理
- [ ] 实现评论列表和回复功能
- [ ] 实现评论筛选和搜索
- [ ] 实现潜在客户识别
- [ ] 实现评论转线索功能

### 私信管理
- [ ] 实现私信列表（如果 API 支持）
- [ ] 实现私信回复
- [ ] 实现私信转线索功能

### 公域转私域
- [ ] 实现公域转私域追踪（评论/私信 → 线索）
- [ ] 实现渠道效果分析
- [ ] 实现内容效果分析

### 数据库
- [ ] 创建 xiaohongshu_posts 表
- [ ] 创建 xiaohongshu_comments 表
- [ ] 创建 xiaohongshu_messages 表

---

## 🧪 第六阶段：系统集成测试

### 测试
- [ ] 端到端测试（引流 → 对话 → 留资 → Airtable → 触发 → 跟进）
- [ ] 性能优化（数据库索引、查询优化）
- [ ] 安全测试（SQL 注入、XSS 等）
- [ ] 压力测试（并发用户、大数据量）

### 文档
- [ ] 编写用户使用手册
- [ ] 编写系统管理员手册
- [ ] 编写 API 文档
- [ ] 录制功能演示视频

---

## 📊 进度统计

- **已完成**：约 60 项任务
- **第一阶段**：12 项任务（进行中）
- **第二阶段**：9 项任务
- **第三阶段**：15 项任务
- **第四阶段**：18 项任务
- **第五阶段**：12 项任务
- **第六阶段**：8 项任务

**总计**：约 134 项任务

---

*最后更新：2026-02-03*

### 知识库内容填充
- [x] 填充客户问询知识库 - 项目介绍
- [x] 填充客户问询知识库 - FAQ
- [x] 填充客户问询知识库 - 注意事项
- [x] 填充客户问询知识库 - 价格政策
- [x] 填充内部管理知识库 - 销售话术
- [x] 填充内部管理知识库 - 心理分析
- [x] 填充内部管理知识库 - 异议处理
- [x] 填充内部管理知识库 - 成交技巧

### AI 客服与知识库集成优化
- [ ] 优化知识库检索算法（增加更多关键词）
- [ ] 实现知识库向量搜索（提升检索准确度）
- [ ] 在对话管理页面显示使用了哪些知识库
- [ ] 测试 AI 客服回答准确性

### Airtable 双向交互实现
- [ ] 实现 AI 对话自动写入 Airtable
- [ ] 实现从 Airtable 读取客户历史记录
- [ ] 实现客户信息增强 AI 回复
- [ ] 测试 Airtable 集成功能


---

## 🎯 紧急任务：客户数据生成和系统完善

### 生成00位详细客户数据
- [x] 创建客户数据生成脚本
- [x] 生成00位客户数据（覆盖7种渠道、4个年龄段、4种心理类型、3档消费能力）
- [x] 导入客户数据到数据库
- [x] 验证数据完整性整性

### 客户画像增强系统
- [x] 扩展客户表结构（心理标签、消费能力、客户分层字段）
- [x] 实现客户分层分级算法
- [x] 创建客户画像管理页面
- [ ] 实现心理标签自动识别（LLM 分析对话）
- [x] 实现客户筛选和搜索功能

### Airtable 双向集成
- [ ] 实现对话自动写入 Airtable
- [ ] 实现从 Airtable 读取客户历史记录
- [ ] 实现客户信息增强 AI 回复
- [ ] 测试 Airtable 集成功能

### 内容生成效果测试
- [ ] 测试项目体验分享生成效果
- [ ] 测试效果对比展示生成效果
- [ ] 测试价格揭秘生成效果
- [ ] 测试避坑指南生成效果
- [ ] 测试节日营销生成效果
- [ ] 优化 prompt 提升生成质量


---

## 🧪 当前任务：测试和完善核心功能

### 测试客户管理功能
- [x] 访问 /dashboard/customers 页面
- [x] 测试搜索功能（姓名、手机、微信）
- [x] 测试客户分层筛选（A/B/C/D级）
- [x] 测试心理类型筛选（恐惧型/贪婪型/安全型/敏感型）
- [x] 验证100位客户数据完整展示
- [x] 检查客户详情弹窗功能
- [x] 验证客户画像信息准确性
- [x] 修复发现的问题

### 完善 Airtable 集成
- [x] 实现对话自动写入 Airtable API
- [x] 实现从 Airtable 读取客户历史记录 API
- [x] 修改 AI 客服逻辑，集成 Airtable 客户数据
- [x] 实现客户信息增强 AI 回复
- [ ] 测试 Airtable 双向同步功能

### 实现心理标签自动识别
- [x] 设计心理标签识别 prompt
- [x] 实现 LLM 分析对话内容 API
- [x] 自动识别客户心理动机和决策类型
- [x] 动态更新客户画像
- [ ] 测试心理标签识别准确性


---

## 🚀 剩余功能开发

### 自动化触发系统
- [ ] 设计触发器数据表结构
- [ ] 实现时间触发器（生日、节日、预约提醒）
- [ ] 实现行为触发器（浏览未咨询、咨询未预约、预约未到店）
- [ ] 实现天气触发器（天气变化推送相关项目）
- [ ] 创建触发器管理页面
- [ ] 实现触发器执行引擎
- [ ] 测试触发器功能

### 小红书运营管理
- [ ] 设计小红书内容数据表结构
- [ ] 实现数据监控（阅读量、点赞、评论、转发）
- [ ] 实现评论管理（自动回复、敏感词过滤）
- [ ] 实现内容排期发布
- [ ] 实现爆款内容分析
- [ ] 创建小红书运营管理页面
- [ ] 测试小红书运营功能

### 图片生成功能
- [ ] 集成图片生成 API
- [ ] 为小红书爽文自动生成配图
- [ ] 实现图片模板管理
- [ ] 测试图片生成功能

### 系统优化
- [ ] 编写完整的单元测试
- [ ] 性能优化（数据库查询、API 响应时间）
- [ ] 安全性检查（SQL 注入、XSS 攻击）
- [ ] 编写系统使用手册
- [ ] 编写 API 文档


---

## 🔧 紧急修复：AI 客服入口问题

- [ ] 在首页添加明显的"在线咨询"按钮，跳转到 /chat
- [ ] 在 Dashboard 导航中添加"客服对话"入口
- [ ] 优化 /chat 页面的可见性和用户体验
- [ ] 测试 AI 客服完整流程
- [ ] 配置 Airtable API
- [ ] 测试 Airtable 双向同步


---

## 🤖 新需求：管理端 AI 助手

### 数据查询 AI 系统
- [x] 设计 AI 数据查询 prompt（支持自然语言转 SQL）
- [x] 实现 AI 查询客户数据 API
- [x] 实现 AI 查询对话数据 API
- [x] 实现 AI 查询统计数据 API
- [x] 支持复杂查询（多条件筛选、时间范围、聚合统计）

### 管理端 AI 对话界面
- [x] 创建管理端 AI 助手页面
- [x] 在 Dashboard 导航中添加“AI 助手”入口
- [x] 实现对话历史记录
- [x] 实现查询结果可视化展示
- [ ] 支持导出查询结果

### 测试和优化
- [ ] 测试各种查询场景
- [ ] 优化 AI 查询准确性
- [ ] 完善错误处理


---

## 🚀 新任务：自动化触发系统和评论管理

### 自动化触发系统
- [ ] 实现时间触发器（生日提醒、节日营销、预约提醒）
- [ ] 实现行为触发器（浏览未咨询、咨询未预约、预约未到店）
- [ ] 实现天气触发器（天气变化推送相关项目）
- [ ] 创建触发器管理界面
- [ ] 实现触发器执行引擎
- [ ] 测试触发器功能

### 小红书评论管理优化
- [ ] 实现评论自动回复模板系统
- [ ] 实现敏感词过滤功能
- [ ] 实现情感分析功能
- [ ] 优化评论管理界面
- [ ] 测试评论管理功能


---

## 📱 新任务：微信小程序开发（方案二：混合开发）

### 创建 Taro 小程序项目
- [ ] 初始化 Taro 项目
- [ ] 配置小程序 AppID 和基础信息
- [ ] 配置 API 请求基础 URL
- [ ] 配置路由和页面结构
- [ ] 配置 Tailwind CSS 和 UI 组件库

### 开发小程序 C 端页面
- [ ] 开发首页（项目展示）
- [ ] 开发 AI 客服对话页面
- [ ] 开发预约表单页面
- [ ] 开发个人中心页面
- [ ] 实现页面间导航和数据传递

### 适配后端 API
- [ ] 添加微信小程序登录支持
- [ ] 适配小程序的请求格式
- [ ] 实现 session 管理
- [ ] 测试 API 兼容性

### 配置和文档
- [ ] 编写小程序配置文档
- [ ] 编写部署说明文档
- [ ] 编写 API 对接文档
- [ ] 编写小程序使用手册


---

## 📱 新任务：企业微信接入（推荐方案）

### 企业微信后端 API 集成
- [ ] 实现 Access Token 管理（自动刷新）
- [ ] 实现「联系我」二维码生成 API
- [ ] 实现客户详情获取 API
- [ ] 实现消息推送 API
- [ ] 实现回调 URL 处理（客户添加事件、消息事件）
- [ ] 实现消息加解密

### 企业微信前端管理界面
- [ ] 创建企业微信配置页面（CorpID、Secret、AgentID）
- [ ] 创建「联系我」管理页面（生成二维码、配置参数）
- [ ] 创建客户同步页面（从企业微信同步客户到数据库）
- [ ] 创建消息推送页面（批量推送、定时推送）
- [ ] 在 Dashboard 导航中添加"企业微信"入口

### 数据同步
- [ ] 实现客户信息自动同步（企业微信 → 数据库）
- [ ] 实现对话记录自动同步（企业微信 → 数据库）
- [ ] 实现标签自动同步（数据库 → 企业微信）
- [ ] 实现双向数据同步定时任务

### 配置和文档
- [ ] 编写企业微信接入文档
- [ ] 编写企业微信配置指南
- [ ] 编写企业微信 API 对接文档
- [ ] 编写企业微信使用手册

### 测试和优化
- [ ] 测试「联系我」二维码生成
- [ ] 测试客户添加事件回调
- [ ] 测试消息推送功能
- [ ] 测试数据同步功能
- [ ] 优化错误处理和日志记录



---

## 🔧 紧急优化：Airtable 配置和管理入口

- [x] 锁定 Airtable 配置（保存后不再显示令牌输入框）
- [x] 在 Dashboard 侧边栏添加“系统管理”入口
- [x] 移除身份验证（测试阶段允许任何人访问）
- [ ] 测试配置锁定功能
- [ ] 测试管理入口导航



---

## 🐛 修复：侧边栏导航问题

- [x] 修复点击菜单项后侧边栏自动收起的问题（桌面端应保持打开）
- [x] 确保移动端点击后正确收起侧边栏
- [ ] 测试所有菜单项的导航行为



---

## 🧪 企业微信模拟环境（认证期间使用）

- [x] 设计模拟环境架构（Mock API + 测试数据）
- [x] 创建企业微信配置数据库表
- [x] 实现模拟 Access Token 管理
- [x] 实现模拟“联系我”二维码生成
- [x] 实现模拟客户添加事件
- [x] 实现模拟消息推送功能
- [x] 创建前端配置页面
- [x] 创建客户管理页面（显示企业微信客户）
- [x] 创建消息推送页面
- [ ] 测试完整流程

